{{ 'component-card.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .wishlist-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 30px;
  }
  
  .wishlist-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    background: white;
  }
  
  .wishlist-card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }
  
  .wishlist-card-content {
    padding: 15px;
  }
  
  .wishlist-card h3 {
    margin: 0 0 10px 0;
    font-size: 16px;
  }
  
  .wishlist-card .price {
    font-weight: bold;
    margin: 10px 0;
  }
  
  .remove-btn {
    background: #dc2626;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
  }
{%- endstyle -%}

<div class="page-width section-{{ section.id }}-padding">
  <h1 class="main-page-title page-title h0">My Wishlist</h1>
  
  <div id="wishlist-empty" style="text-align: center; padding: 40px; display: none;">
    <h2>Your wishlist is empty</h2>
    <p>Add some products to your wishlist to see them here.</p>
    <a href="/collections/all" class="button">Continue Shopping</a>
  </div>
  
  <div id="wishlist-items" class="wishlist-grid">
    <!-- Wishlist items will be populated here -->
  </div>
</div>

<script>
  function loadWishlist() {
    const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
    const container = document.getElementById('wishlist-items');
    const emptyState = document.getElementById('wishlist-empty');
    
    if (wishlist.length === 0) {
      emptyState.style.display = 'block';
      container.style.display = 'none';
      return;
    }
    
    emptyState.style.display = 'none';
    container.style.display = 'grid';
    container.innerHTML = '';
    
    wishlist.forEach(item => {
      const productCard = `
        <div class="wishlist-card">
          <img src="${item.image}" alt="${item.title}">
          <div class="wishlist-card-content">
            <h3><a href="${item.url}">${item.title}</a></h3>
            <div class="price">${item.price}</div>
            <button onclick="removeFromWishlist('${item.id}')" class="remove-btn">
              Remove from Wishlist
            </button>
          </div>
        </div>
      `;
      container.innerHTML += productCard;
    });
  }
  
  function removeFromWishlist(productId) {
    let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
    wishlist = wishlist.filter(item => item.id !== productId);
    localStorage.setItem('wishlist', JSON.stringify(wishlist));
    loadWishlist();
    if (window.updateWishlistCount) {
      window.updateWishlistCount();
    }
  }
  
  document.addEventListener('DOMContentLoaded', loadWishlist);
</script>

{% schema %}
{
  "name": "Wishlist",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 36
    }
  ]
}
{% endschema %}